{"version":3,"file":"static/chunks/pages/index-829fa6c590f6d997.js","mappings":"AEACA,CAAAA,IAAI,CAAC,gBAAkB,CAAIA,IAAI,CAAC,gBAAkB,EAAK,EAAE,EAAEC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAEnE,KAAK,CACJ,SAASC,CAAuB,CAAEC,CAAwB,CAAEC,CAAmB,CAAE,CFDxF,CAAAC,MAAA,CAAAC,QAAA,CAAAD,MAAA,CAAAC,QAAA,MAAAL,IAAA,EACA,IACA,UAAe,CACf,OAAAG,CAAA,QACA,CACA,EAKA,gBAAAF,CAAA,CAAAK,CAAA,CAAAH,CAAA,iBAAAI,CAAA,CAAAD,CAAA,EAAAH,CAAA,CAAAK,CAAA,CAAAF,CAAA,4BAAAG,CAAA,QAAAC,CAAA,CAAAP,CAAA,QAAAQ,CAAA,CAAAR,CAAA,QCZAS,CAAA,CAAAT,CAAA,QAckEU,CAA7C,UAAaC,CAAb,EACnB,IAAAC,CAAA,CAAAD,CACE,CAAAC,aAAA,CAAAC,CAAA,CAAAF,CAAA,CAAAE,kBAAC,CAAAC,CAAA,CAAAH,CAAA,CAAAG,GAAA,OACQ,GAAAP,CAAA,CAAAQ,GAAA,EAAAP,CAAA,CAAAQ,EAAA,EAAAC,KACL,EAAUC,QACR,EACAN,aAAA,CAAAA,CAAA,CACAC,kBAAG,CAAAA,CAAA,CACJC,GAAA,CAAAA,CAAA,CACF,EAKJK,QAAA,IAAAZ,CAAA,CAAAQ,GAAA,EAAAN,CAAA,CAAAW,CAAA,KACF,EA+GD,CAAqBV,CAAA,CAAAW,MAAA,QAErBf,CAAA,IAAwBH,CAAA,SAAAO,CAAA,YAAAV,CAAA,EAAAA,CAAA,CAAAsB,CAAA,sGAAAtB,CAAA,CAAAA,CAAA,CAAAuB,CAAA,UAAAC,IAAA,CAAAxB,CAAA,CAAAsB,CAAA","sources":["webpack://_N_E/","webpack://_N_E/./src/pages/index.tsx","webpack://_N_E/<anon>"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/\",\n      function () {\n        return require(\"private-next-pages/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/\"])\n      });\n    }\n  ","import { formatEther } from '@ethersproject/units'\nimport { FACTORY_ADDRESS } from '@pancakeswap/sdk'\nimport { getUnixTime, sub } from 'date-fns'\nimport { gql } from 'graphql-request'\nimport { GetStaticProps } from 'next'\nimport { SWRConfig } from 'swr'\nimport { getCakeVaultAddress } from 'utils/addressHelpers'\nimport { getCakeContract } from 'utils/contractHelpers'\nimport { getBlocksFromTimestamps } from 'utils/getBlocksFromTimestamps'\nimport { bitQueryServerClient, infoServerClient } from 'utils/graphql'\n// import Home from '../views/Home'\nimport Swap from '../views/Swap'\n\n\nconst IndexPage = ({ totalTx30Days, addressCount30Days, tvl }) => {\n  return (\n    <SWRConfig\n      value={{\n        fallback: {\n          totalTx30Days,\n          addressCount30Days,\n          tvl,\n        },\n      }}\n    >\n      <Swap/>\n      {/* <Home /> */}\n    </SWRConfig>\n  )\n}\n\n// Values fetched from TheGraph and BitQuery jan 24, 2022\nconst txCount = 54780336\nconst addressCount = 4425459\n\nconst tvl = 6082955532.115718\n\nexport const getStaticProps: GetStaticProps = async () => {\n  const totalTxQuery = gql`\n    query TotalTransactions($id: ID!, $block: Block_height) {\n      pancakeFactory(id: $id, block: $block) {\n        totalTransactions\n      }\n    }\n  `\n\n  const days30Ago = sub(new Date(), { days: 30 })\n\n  const results = {\n    totalTx30Days: txCount,\n    addressCount30Days: addressCount,\n    tvl,\n  }\n\n  if (process.env.SF_HEADER) {\n    try {\n      const [days30AgoBlock] = await getBlocksFromTimestamps([getUnixTime(days30Ago)])\n\n      if (!days30AgoBlock) {\n        throw new Error('No block found for 30 days ago')\n      }\n\n      const totalTx = await infoServerClient.request(totalTxQuery, {\n        id: FACTORY_ADDRESS,\n      })\n      const totalTx30DaysAgo = await infoServerClient.request(totalTxQuery, {\n        block: {\n          number: days30AgoBlock.number,\n        },\n        id: FACTORY_ADDRESS,\n      })\n\n      if (\n        totalTx?.pancakeFactory?.totalTransactions &&\n        totalTx30DaysAgo?.pancakeFactory?.totalTransactions &&\n        parseInt(totalTx.pancakeFactory.totalTransactions) > parseInt(totalTx30DaysAgo.pancakeFactory.totalTransactions)\n      ) {\n        results.totalTx30Days =\n          parseInt(totalTx.pancakeFactory.totalTransactions) -\n          parseInt(totalTx30DaysAgo.pancakeFactory.totalTransactions)\n      }\n    } catch (error) {\n      if (process.env.NODE_ENV === 'production') {\n        console.error('Error when fetching total tx count', error)\n      }\n    }\n  }\n\n  const usersQuery = gql`\n    query userCount($since: ISO8601DateTime, $till: ISO8601DateTime) {\n      ethereum(network: bsc) {\n        dexTrades(exchangeName: { in: [\"Pancake\", \"Pancake v2\"] }, date: { since: $since, till: $till }) {\n          count(uniq: senders)\n        }\n      }\n    }\n  `\n\n  if (process.env.BIT_QUERY_HEADER) {\n    try {\n      const result = await bitQueryServerClient.request(usersQuery, {\n        since: days30Ago.toISOString(),\n        till: new Date().toISOString(),\n      })\n      if (result?.ethereum?.dexTrades?.[0]?.count) {\n        results.addressCount30Days = result.ethereum.dexTrades[0].count\n      }\n    } catch (error) {\n      if (process.env.NODE_ENV === 'production') {\n        console.error('Error when fetching address count', error)\n      }\n    }\n  }\n\n  try {\n    const result = await infoServerClient.request(gql`\n      query tvl {\n        pancakeFactories(first: 1) {\n          totalLiquidityUSD\n        }\n      }\n    `)\n    const cake = await (await fetch('https://farms.pancake-swap.workers.dev/price/cake')).json()\n    const { totalLiquidityUSD } = result.pancakeFactories[0]\n    const cakeVaultV2 = getCakeVaultAddress()\n    const cakeContract = getCakeContract()\n    const totalCakeInVault = await cakeContract.balanceOf(cakeVaultV2)\n    results.tvl = parseFloat(formatEther(totalCakeInVault)) * cake.price + parseFloat(totalLiquidityUSD)\n  } catch (error) {\n    if (process.env.NODE_ENV === 'production') {\n      console.error('Error when fetching tvl stats', error)\n    }\n  }\n\n  return {\n    props: results,\n    revalidate: 60 * 60 * 24 * 30, // 30 days\n  }\n}\n\nIndexPage.chains = []\n\nexport default IndexPage\n","(self[\"webpackChunk_N_E\"] = self[\"webpackChunk_N_E\"] || []).push([[5405],{\n\n/***/ 87314:\n/***/ (function(__unused_webpack_module, __unused_webpack_exports, __webpack_require__) {\n\n\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/\",\n      function () {\n        return __webpack_require__(53386);\n      }\n    ]);\n    if(false) {}\n  \n\n/***/ }),\n\n/***/ 53386:\n/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"__N_SSG\": function() { return /* binding */ __N_SSG; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(52322);\n/* harmony import */ var swr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(49857);\n/* harmony import */ var _views_Swap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(59644);\n\n\n// import Home from '../views/Home'\n\nvar IndexPage = function(param) {\n    var totalTx30Days = param.totalTx30Days, addressCount30Days = param.addressCount30Days, tvl = param.tvl;\n    return /*#__PURE__*/ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(swr__WEBPACK_IMPORTED_MODULE_1__/* .SWRConfig */ .J$, {\n        value: {\n            fallback: {\n                totalTx30Days: totalTx30Days,\n                addressCount30Days: addressCount30Days,\n                tvl: tvl\n            }\n        },\n        children: /*#__PURE__*/ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_views_Swap__WEBPACK_IMPORTED_MODULE_2__/* [\"default\"] */ .Z, {})\n    });\n};\nIndexPage.chains = [];\nvar __N_SSG = true;\n/* harmony default export */ __webpack_exports__[\"default\"] = (IndexPage);\n\n\n/***/ })\n\n},\n/******/ function(__webpack_require__) { // webpackRuntimeModules\n/******/ var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }\n/******/ __webpack_require__.O(0, [1820,4273,9521,3492,3763,8934,1353,7553,3412,6849,6150,5389,9644,9774,2888,179], function() { return __webpack_exec__(87314); });\n/******/ var __webpack_exports__ = __webpack_require__.O();\n/******/ _N_E = __webpack_exports__;\n/******/ }\n]);"],"names":["self","push","__unused_webpack_module","__unused_webpack_exports","__webpack_require__","window","__NEXT_P","__webpack_exports__","r","d","__N_SSG","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","swr__WEBPACK_IMPORTED_MODULE_1__","_views_Swap__WEBPACK_IMPORTED_MODULE_2__","IndexPage","param","totalTx30Days","addressCount30Days","tvl","jsx","J$","value","fallback","children","Z","chains","O","s","_N_E"],"sourceRoot":""}